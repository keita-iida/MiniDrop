# MiniDrop

MiniDrop is a minimal, fully transparent Drop-seqâ€“style processing pipeline designed for educational and exploratory use.  
It provides a lightweight dataset containing **a single cell** and **a single human gene (e.g., MYC)**, allowing users to understand how raw scRNA-seq data (FASTQ/BAM) are structured and transformed into a read count table.

MiniDrop is ideal for:

- Learning the internal structure of FASTQ and BAM files  
- Understanding how Drop-seq Tools operate  
- Demonstrating barcode/UMI extraction  
- Exploring read alignment and counting  
- Use in hands-on workshops and teaching

<br>

<img src="vignettes/figure_00_0001.png" width="500px">

---

## 1. Overview

MiniDrop simulates the essential steps of a Drop-seq pipeline:

1. Generate minimal FASTQ files  
2. Convert FASTQ â†’ BAM  
3. Add cell barcode and UMI tags  
4. Perform read-level QC, adapter trimming, and polyA removal  
5. Convert BAM â†’ FASTQ  
6. Align reads to a minimal reference (MYC locus only)  
7. Sort/merge BAM files and annotate gene-level information  
8. Produce the final read count table

Scripts are named with numeric prefixes to indicate execution order, e.g., `pg_005_03_umi_tag.sh`.

A single wrapper script, `all_initialize_runall.sh`, executes the full pipeline.

---

## 2. Requirements

MiniDrop requires a Linux or Linux-like environment.

**Note:** macOS was not fully compatible in pretests; macOS users may experience issues.

### Required tools

- **samtools**  
- **Picard**  
- **Drop-seq Tools**  
- **STAR**

### Recommended installation (Conda)

```bash
conda install bioconda::dropseq_tools
```

---

## 3. Folder Structure

```
MiniDrop/
â”œâ”€â”€ LICENSE
â”œâ”€â”€ README.md
â””â”€â”€ bash/
    â”œâ”€â”€ 001_data/
    â”œâ”€â”€ 002_input/
    â”œâ”€â”€ 003_bam/
    â”œâ”€â”€ 004_fastq/
    â”œâ”€â”€ 005_bam/
    â”œâ”€â”€ 006_fastq/
    â”œâ”€â”€ 007_bam/
    â”œâ”€â”€ 008_count/
    â”œâ”€â”€ all_initialize_runall.sh
    â”œâ”€â”€ pg_001_02_create_reference_myc.sh
    â”œâ”€â”€ pg_004_01_create_fastq.sh
    â”œâ”€â”€ pg_005_01_fastq2bam.sh
    â”œâ”€â”€ pg_005_02_cellbarcode_tag.sh
    â”œâ”€â”€ pg_005_03_umi_tag.sh
    â”œâ”€â”€ pg_005_04_read_qc.sh
    â”œâ”€â”€ pg_005_05_remove_adapter.sh
    â”œâ”€â”€ pg_005_06_trim_polya.sh
    â”œâ”€â”€ pg_005_07_bam2fastq.sh
    â”œâ”€â”€ pg_006_01_star__________wREF.sh
    â”œâ”€â”€ pg_007_01_sorting.sh
    â”œâ”€â”€ pg_007_02_cb_umi__________wREF.sh
    â”œâ”€â”€ pg_007_03_genes__________wREF.sh
    â”œâ”€â”€ pg_007_04_fix_beads.sh
    â”œâ”€â”€ pg_007_05_fix2nd_beads.sh
    â””â”€â”€ pg_008_01_counts.sh
```

---

## 4. Directory Descriptions

| Directory | Description |
|-----------|-------------|
| **001_data/** | Minimal MYC-only reference genome (chr8 locus) |
| **002_input/** | Cell barcode file and gene list (Ensembl ID) |
| **003_bam/** | Example MYC-aligned BAM fragments for viewing |
| **004_fastq/** | Minimal FASTQ files generated by early steps |
| **005_bam/** | Output from `pg_005_*` scripts |
| **006_fastq/** | FASTQ files generated after alignment |
| **007_bam/** | Output from `pg_007_*` scripts |
| **008_count/** | Final read count table |

---

## 5. Scripts

Scripts follow the naming format:

```
pg_<STEP>_<ORDER>_<DESCRIPTION>.sh
```

Examples:

- `pg_004_01_create_fastq.sh` â€” generate minimal FASTQ files  
- `pg_005_02_cellbarcode_tag.sh` â€” attach cell barcode  
- `pg_006_01_star__________wREF.sh` â€” align reads to MYC reference  
- `pg_008_01_counts.sh` â€” generate final count table  

### Run the entire pipeline

```bash
bash all_initialize_runall.sh
```

---

## 6. Usage

A full walkthrough of how MiniDrop works â€” including how to inspect FASTQ/BAM files, understand barcodes and UMIs, and interpret each pipeline step â€” is provided in the tutorial:

ðŸ‘‰ **[MiniDrop Tutorial (HTML)](tutorial_minidrop.html)**

This tutorial covers:

- The conceptual flow of the pipeline  
- How each script transforms the data  
- How to read and interpret intermediate outputs  
- The logic behind building a minimal single-cell dataset  

If you follow the tutorial, you will be able to reproduce the entire analysis and understand every processing step in detail.

---

## 7. Educational Benefits

MiniDrop helps users understand:

- FASTQ structure (barcodes, UMIs, cDNA)  
- How BAM files change during processing  
- How aligners encode mapping  
- How Drop-seq Tools annotate reads  
- How raw reads become a count table  

Because only **one gene** and **one cell** are included, results are easy to inspect manually.

---

## 8. Licence

This project is distributed under the terms of the **LICENSE** file.
